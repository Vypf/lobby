# Development override
# Usage: docker compose -f docker-compose.yml -f docker-compose.dev.yml up -d --build

services:
  router:
    image: lobby-router
    build:
      context: .
      dockerfile: Dockerfile.router
    ports:
      - "80:80"

  hub:
    image: lobby-hub
    build:
      context: .
      dockerfile: Dockerfile.hub
    ports:
      - "17018:17018"
    command:
      - "environment=development"
      - "spawner_api_url=http://spawner:8080"
      - "lobby_url=ws://router/lobby"

  spawner:
    image: lobby-spawner
    build:
      context: .
      dockerfile: Dockerfile.spawner
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./images.json:/app/images.json:ro
    ports:
      - "8080:8080"
    command:
      - "server_type=spawner"
      - "environment=development"
      - "images_file=/app/images.json"
