# Production override
# Usage: SERVER_NAME=example.com docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
#
# Required environment variables:
#   - SERVER_NAME: Domain name (e.g., localhost, games.example.com)
#
# Certificate setup:
#   - Local: ./scripts/generate-certs.sh localhost
#   - Production: Mount Let's Encrypt certs to ./certs/${SERVER_NAME}/

services:
  router:
    ports:
      - "80:80"
      - "443:443"
    environment:
      - SERVER_NAME=${SERVER_NAME}
    volumes:
      - ./certs/${SERVER_NAME}:/etc/ssl/certs/${SERVER_NAME}:ro

  hub:
    command:
      - "environment=production"
      - "spawner_api_url=http://spawner:8080"
      - "lobby_url=ws://router/lobby"

  spawner:
    command:
      - "server_type=spawner"
      - "environment=production"
      - "images_file=/app/images.json"
